Downloading: "https://download.pytorch.org/models/resnet50-19c8e357.pth" to ./pretrained_models/resnet50-19c8e357.pth
DATASET:
  GENETIC:
    FIX_PROTOTYPES: True
    MODEL_PATH: NA
    ORDER_NAME: NA
    PROTOTYPE_SHAPE: (0, 0, 0, 0)
    SIZE: 0
    TAXONOMY_NAME: NA
    TRAIN_PATH: NA
    TRAIN_PUSH_DIR: NA
    TRANSFORM: onehot
    VALIDATION_PATH: NA
  IMAGE:
    IMAGE_SIZE: 224
    MODEL_PATH: NA
    PROTOTYPE_SHAPE: (0, 0, 0, 0)
    SIZE: 224
    TEST_DIR: datasets/cub200_cropped/test_cropped
    TRAIN_BATCH_SIZE: 0
    TRAIN_DIR: datasets/cub200_cropped/train_cropped_augmented
    TRAIN_PUSH_DIR: datasets/cub200_cropped/train_cropped
    TRANSFORM_MEAN: (0.485, 0.456, 0.406)
    TRANSFORM_STD: (0.229, 0.224, 0.225)
  NAME: cub
  NUM_CLASSES: 200
  TEST_BATCH_SIZE: 80
  TRAIN_BATCH_SIZE: 80
  TRAIN_PUSH_BATCH_SIZE: 75
EXPERIMENT_RUN: 1
MODEL:
  ADD_ON_LAYERS_TYPE: regular
  BACKBONE: resnet50
  DEVICE: cuda
  GENETIC_MODE: False
  PROTOTYPE_ACTIVATION_FUNCTION: log
  PROTOTYPE_DISTANCE_FUNCTION: l2
  PROTOTYPE_SHAPE: (2000, 128, 1, 1)
OPTIM:
  COEFS:
    CLST: 0.8
    CRS_ENT: 1
    L1: 0.0001
    SEP: -0.08
  JOINT_OPTIMIZER_LAYERS:
    ADD_ON_LAYERS: 0.003
    FEATURES: 0.0001
    LR_STEP_SIZE: 5
    PROTOTYPE_VECTORS: 0.003
    WEIGHT_DECAY: 0.001
  LAST_LAYER_OPTIMIZER_LAYERS:
    LR: 0.0001
  NUM_TRAIN_EPOCHS: 100
  NUM_WARM_EPOCHS: 5
  PUSH_EPOCHS: [0, 10, 20, 30, 40, 50, 60, 70, 80, 90]
  PUSH_START: 10
  WARM_OPTIMIZER_LAYERS:
    ADD_ON_LAYERS: 0.003
    PROTOTYPE_VECTORS: 0.003
    WEIGHT_DECAY: 0.001
OUTPUT:
  IMG_DIR: saved_models/cub/vgg19/003/img
  MODEL_DIR: saved_models/cub/vgg19/003
  NO_SAVE: False
  PREPROCESS_INPUT_FUNCTION: None
  PROTOTYPE_IMG_FILENAME_PREFIX: prototype-img
  PROTOTYPE_SELF_ACT_FILENAME_PREFIX: prototype-self-act
  PROTO_BOUND_BOXES_FILENAME_PREFIX: bb
  WEIGHT_MATRIX_FILENAME: outputL_weights
  0%|          | 0.00/97.8M [00:00<?, ?B/s]  2%|▏         | 1.77M/97.8M [00:00<00:05, 18.5MB/s] 20%|█▉        | 19.1M/97.8M [00:00<00:00, 115MB/s]  40%|████      | 39.1M/97.8M [00:00<00:00, 158MB/s] 60%|██████    | 59.0M/97.8M [00:00<00:00, 178MB/s] 81%|████████  | 79.2M/97.8M [00:00<00:00, 190MB/s]100%|██████████| 97.8M/97.8M [00:00<00:00, 172MB/s]
start training
epoch: 	0
	warm
	train
	time: 	592.0717000961304
	cross ent: 	4.675392231212094
	cluster: 	0.6165625649022529
	separation:	0.41575026911392265
	avg separation:	11.055071379507131
	accu: 		4.476862868936583%
	l1: 		201000.0
	p dist pair: 	21.859224319458008
	balanced accu:	0.04413946345448494
	mode: 	train
	test
	time: 	18.68086004257202
	cross ent: 	3.916579677634043
	cluster: 	0.17828305535120506
	separation:	0.0472728491135656
	avg separation:	10.452399149332962
	accu: 		9.596133931653435%
	l1: 		201000.0
	p dist pair: 	21.859224319458008
	balanced accu:	0.09439746290445328
	mode: 	test
epoch: 	1
	warm
	train
	time: 	571.0308353900909
	cross ent: 	3.3688321894334683
	cluster: 	0.18850027162532954
	separation:	0.05880060190747437
	avg separation:	9.148753841556726
	accu: 		18.239593084236525%
	l1: 		201000.0
	p dist pair: 	18.06692123413086
	balanced accu:	0.17981475591659546
	mode: 	train
	test
	time: 	17.45928430557251
	cross ent: 	2.9431911543624043
	cluster: 	0.1913106959976562
	separation:	0.07072803490374187
	avg separation:	8.0864713159326
	accu: 		26.337590610976875%
	l1: 		201000.0
	p dist pair: 	18.06692123413086
	balanced accu:	0.2631818652153015
	mode: 	test
epoch: 	2
	warm
	train
	time: 	569.5511417388916
	cross ent: 	2.6337297841886382
	cluster: 	0.21099026540834515
	separation:	0.07530898972001493
	avg separation:	7.286183783746702
	accu: 		32.07506738696471%
	l1: 		201000.0
	p dist pair: 	15.436896324157715
	balanced accu:	0.3162141740322113
	mode: 	train
	test
	time: 	17.266627073287964
	cross ent: 	2.469020822276808
	cluster: 	0.2346126680096535
	separation:	0.09670431615963374
	avg separation:	6.659031044946958
	accu: 		36.313427683810836%
	l1: 		201000.0
	p dist pair: 	15.436896324157715
	balanced accu:	0.3634780943393707
	mode: 	test
epoch: 	3
	warm
	train
	time: 	571.4468262195587
	cross ent: 	2.255264297658708
	cluster: 	0.22054522701975565
	separation:	0.08098845417415122
	avg separation:	6.069544797552347
	accu: 		40.636313397318055%
	l1: 		201000.0
	p dist pair: 	13.609017372131348
	balanced accu:	0.40062186121940613
	mode: 	train
	test
	time: 	17.062244653701782
	cross ent: 	2.2382144372757167
	cluster: 	0.22760307319360237
	separation:	0.08279001294341806
	avg separation:	5.669605300851064
	accu: 		41.404901622367966%
	l1: 		201000.0
	p dist pair: 	13.609017372131348
	balanced accu:	0.4163367450237274
	mode: 	test
epoch: 	4
	warm
	train
	time: 	568.3323862552643
	cross ent: 	1.9990588107192953
	cluster: 	0.22503470211051638
	separation:	0.08720677037482655
	avg separation:	5.223942793646964
	accu: 		46.81730519810076%
	l1: 		201000.0
	p dist pair: 	12.282580375671387
	balanced accu:	0.4616263210773468
	mode: 	train
	test
/home/users/mb625/miniconda3/envs/protopnet/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:136: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
	time: 	17.677997589111328
	cross ent: 	2.16069302166978
	cluster: 	0.23103420293494448
	separation:	0.08580771374375853
	avg separation:	4.970842779499211
	accu: 		43.06178805661028%
	l1: 		201000.0
	p dist pair: 	12.282580375671387
	balanced accu:	0.43388015031814575
	mode: 	test
epoch: 	5
	joint
	train
	time: 	704.1572008132935
	cross ent: 	0.8982379725509578
	cluster: 	0.17453770512226846
	separation:	0.09332344094589588
	avg separation:	4.854553185662118
	accu: 		75.32170931688226%
	l1: 		201000.0
	p dist pair: 	11.69773006439209
	balanced accu:	0.7427392601966858
	mode: 	train
	test
	time: 	17.668007850646973
	cross ent: 	1.2891580221587664
	cluster: 	0.16940922136992626
	separation:	0.08390727812704975
	avg separation:	4.761961022468462
	accu: 		66.75871591301346%
	l1: 		201000.0
	p dist pair: 	11.69773006439209
	balanced accu:	0.669709324836731
	mode: 	test
epoch: 	6
	joint
	train
	time: 	706.9318604469299
	cross ent: 	0.3084935883499504
	cluster: 	0.1165542087014
	separation:	0.0902909466313735
	avg separation:	4.617882933765045
	accu: 		91.34965658023843%
	l1: 		201000.0
	p dist pair: 	11.42593002319336
	balanced accu:	0.901953399181366
	mode: 	train
	test
	time: 	17.905820608139038
	cross ent: 	1.219241594206797
	cluster: 	0.16638030285296374
	separation:	0.09102819007757591
	avg separation:	4.714023139378796
	accu: 		70.24508111839835%
	l1: 		201000.0
	p dist pair: 	11.42593002319336
	balanced accu:	0.7045939564704895
	mode: 	test
	above 70.00%
Traceback (most recent call last):
  File "/home/users/mb625/MultiModalPPNet/main.py", line 141, in <module>
    main()
  File "/home/users/mb625/MultiModalPPNet/main.py", line 100, in main
    save_model_w_condition(model=ppnet, model_dir=cfg.OUTPUT.MODEL_DIR, model_name=str(epoch) + 'nopush', accu=accu,
  File "/home/users/mb625/MultiModalPPNet/utils/util.py", line 72, in save_model_w_condition
    torch.save(obj=model, f=os.path.join(model_dir, (model_name + '{0:.4f}.pth').format(accu)))
  File "/home/users/mb625/miniconda3/envs/protopnet/lib/python3.10/site-packages/torch/serialization.py", line 618, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/users/mb625/miniconda3/envs/protopnet/lib/python3.10/site-packages/torch/serialization.py", line 492, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/users/mb625/miniconda3/envs/protopnet/lib/python3.10/site-packages/torch/serialization.py", line 463, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: File saved_models/cub/vgg19/003/6nopush0.7025.pth cannot be opened.
